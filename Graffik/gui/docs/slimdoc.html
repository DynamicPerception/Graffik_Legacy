<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html
  xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta content="text/html; charset=ISO-8859-1" http-equiv="content-type" />
    <title>Slim User Guide</title>
    <meta content="Amaya, see http://www.w3.org/Amaya/" name="generator" />
  </head>
  <body>
    <h1>Slim User Guide</h1>
    <h2><a name="overview">Slim Overview</a></h2>
    <p>Slim is a low-level interface for interacting directly with
      MoCoBus-enabled devices through well-defined languages specific to each
      device. It is designed to interact with devices using their entire command
      set and to automate activities through pre-defined (or saved) scripts. </p>
    <p>Unlike workflow-specific graphical interfaces, Slim gives the user raw
      access to the devices, unconstrained by graphical UI constructs. This type
      of interface can be most useful for new cases where a specific workflow
      has not yet been developed, or for advanced users that wish to break free
      of constraints and instruct their devices according to their exact
      specification. It is not designed to replace other graphical interfaces,
      but instead to compliment them.</p>
    <h3><a id="Slim" name="ui">The Slim UI</a></h3>
    <p>The Slim User Interface is made up of three key sections: Command
      History, Command Results, and Command Entry. </p>
    <p align="center"><img width="797" height="576" src="slim-ovr.png" alt="Slim Screen Overview" /></p>
    <p>The Command History section shows all commands entered, and will
      automatically scroll as needed. In the Command Results section, any
      command which has a data response back from a node will show the response
      as returned from the node. Scripting commands are entered in the Command
      Entry section.</p>
    <p></p>
    <h3><a id="Command" name="command">Command History</a></h3>
    <p>The Command History section displays all commands that have been issued
      to all devices on the network. Each command shows the bus the device lives
      on, the status of the command, the device the command was issued to, and
      the command that was issued. </p>
    <p>In the case of a successful command, the status of the command is shown
      with a green light. Failed, or timed-out commands will have a red light,
      and commands queued but not yet complete will have a blue light.<br />
    </p>
    <p></p>
    <h3><a id="Command1" name="Command1">Command Entry</a></h3>
    <p>Commands are typed into the command entry section. All commands begin
      with the name, address, or alias of a node device on the bus, then a
      command name and arguments for the command. One may either press enter
      after typing the command, or press the Go button to issue to the command
      to the device.</p>
    <p></p>
    <h2 id="MoCoBus"><a name="mocobus">The MoCoBus Network</a></h2>
    <p>To understand how devices and buses are related, we must first define a
      few terms relevant to MoCoBus:</p>
    <p></p>
    <ul>
      <li>Node Device
        <ul>
          <li>A Node Device is a device which lives on the bus, and accepts
            commands to take action on behalf of the user. Examples of this are
            the nanoMoCo stepper controller, a device to run a camera, a device
            to control lighting, etc.</li>
        </ul>
      </li>
      <li>Master Device
        <ul>
          <li>A Master Device is a device which instructs node devices to
            perform actions for the user. It must understand the command set for
            each Node Device it controls to effectively manage the bus. There
            may be only one Master Device active on a bus at a time. A computer
            running Slim is a Master Device</li>
        </ul>
      </li>
      <li>Bus
        <ul>
          <li>A Bus is a group of directly connected devices. Each device on a
            bus will share the same data lines at the same time. For a computer
            running Slim, it typically connects to a bus using a specialized
            cable which plugs into the USB port and allows the computer to
            communicate with a bus. The MoCoBus specification limits a bus to a
            maximum of 253 devices.</li>
        </ul>
      </li>
      <li>Network
        <ul>
          <li>A network is a group of one or more buses. Slim is capable of
            controlling devices across multiple buses, should wiring or other
            limitations require the user to have more than one bus operating.
            The MoCoBus specification requires all devices on a connected
            Network to have unique addresses, and therefor the entire network is
            limited to 253 devices.</li>
        </ul>
      </li>
    </ul>
    <p></p>
    <h3><a id="Managing" name="managing">Managing the Network and Devices in
        Slim</a></h3>
    <p>The Manage Network screen allows you to manage buses, and devices
      directly.  To access this screen, go to Network and then select Manage
      Network.</p>
    <p align="center"><img src="slim-mn.png" alt="" /><br />
    </p>
    <p>Before you can add a device, you must add a bus. To add a bus, choose the
      'Manage Network' option at the top, and then select 'Add Bus'. The dialog
      will present a list of available serial devices, and allow you to choose a
      name for the bus. The bus will be identified by this name in the future.
      You may also choose a color for the bus, this will be displayed in the
      Command History section to help identify which bus the device is on when
      viewing the command history. When saving this bus, Slim will automatically
      connect to the bus.</p>
    <p>After you have added a bus, you may now manually add your devices which
      live on the bus, or scan for devices on the bus. To manually add a device,
      click on 'Add Device'. You will be prompted to select the bus which the
      device is connected to, enter the address, and the name of the device. If
      you choose an address or name which is already in-use, an error will be
      presented.</p>
    <p>All bus and device information is stored permanently, and Slim will
      automatically re-connect to the buses you've added and restore all devices
      when started. You may delete any existing device or bus in the 'Manage
      Network' window.</p>
    <h3><a name="scan">Scanning for Devices on the Network</a></h3>
    <p>You can scan for devices on all currently connected buses using the Scan
      for Devices option under Network.  Clicking this option will present the
      scanning screen which shows scanning progress, and notes which devices it
      finds.  During scanning, it will find all attached devices and discover
      what type of device they are.  If no devices are found after scanning has
      completed, click Cancel or Done to dismiss the screen.  </p>
    <p align="center"><img src="slim-scan1.png" alt="" /><br />
    </p>
    <p>If devices are found, the Next button will be activated.  When you click
      this button, you will be prompted to provide a name for every device
      found.  If a particular device type is not known or supported, you will be
      given an error for that device and be allowed to proceed to the next found
      device.</p>
    <p align="center"><img src="slim-scan2.png" alt="" /></p>
    <p align="center"><img src="slim-scan3.png" alt="" /><br />
    </p>
    <h3><a name="init">Initializing a Device for the First Time</a></h3>
    <p>When you get a new MoCoBus device, it comes with a default address of
      '2'.  There are two ways to initialize the device for the first time:
      either automatically, or manually.  <br />
    </p>
    <p>To initialize a new device automatically, go to Network, and then
      Initialize Device.  The device scanning screen will be presented, and if
      the device is discovered at address 2, the Next button will be displayed.<br />
    </p>
    <p>For manual initialization, see Changing Device Addresses below.  <br />
    </p>
    <p></p>
    <h3 id="Changing"><a name="changeaddr">Changing Device Addresses</a></h3>
    <p>All MoCoBus compatible devices support the core address change command
      (see Slim Scripting, below). After connecting the device and adding it as
      a new device using its default address, you should then submit an address
      change command to the device using the core scripting command, with a new
      and unique address. Afterwards, using the Network Manager, delete the old
      device address and add a new device with the new address.  Alternatively,
      if you are initializing a device for the first time, you can use the
      Initialize Device option to automate this process.  See the section
      directly above this one.<br />
    </p>
    <p></p>
    <h1><a id="Slim2" name="scripting">Slim Scripting</a></h1>
    <p>Slim is designed as a scripting environment, and can be done
      interactively or via saved scripts. Each slim script consists of a number
      of commands, prefixed with a device name, address, or alias - directing
      slim as to which device the script command should be sent to. Note that
      for many commands that accept Boolean arguments, such as "enable or
      disable," or "on or off," you can substitute the numeric values of 1 and 0
      for the textual argument.<br />
    </p>
    <h3 id="Creating"><a name="createscript">Creating A Slim Script</a></h3>
    <p>There are two ways to create a slim script: you can either create one by
      hand, using your favorite text editor, or capture the history in a current
      slim session to a file for future playback. </p>
    <p>Within a slim script, each command must exist on a line of its own. Any
      line that begins with a # symbol is considered a comment, and is ignored
      by the parser. Blank lines are ignored, and leading whitespace is trimmed
      from any line. Slim scripts should generally end in a '.slim' file
      extension to differentiate them from other files. Like in the interactive
      command entry, every slim command must be prefixed by a device name,
      address, or alias.</p>
    <p>To capture the command history to a script file, choose 'File' and then
      'Save Slim Script'. The entire command history will be saved into the
      file.</p>
    <h3 id="Loading"><a name="loadscript">Loading a Slim Script</a></h3>
    <p>To load a saved slim script, choose 'File' and then 'Open Slim Script'.
      The script will be loaded, parsed, and the commands issued as they are
      parsed. If there are any errors attempting to issue any commands, they
      will be reported after loading and executing is completed.</p>
    <p></p>
    <h3 id="Core"><a name="corescript">Core Slim Scripting Commands</a></h3>
    <p>There are two types of core scripting commands: those recognized by the
      slim interpreter and handled without contacting a device, and those which
      every device must understand. They are documented here. For
      device-specific commands, see the section specific to that device.</p>
    <p>The following core commands are defined for every device:</p>
    <table border="1" style="width: 100%">
      <caption><br />
      </caption> <colgroup><col /> <col /> </colgroup>
      <tbody>
        <tr>
          <td><strong>Command</strong></td>
          <td><strong>Description</strong></td>
        </tr>
        <tr>
          <td>status id</td>
          <td>Requests the device identifier string from the node device</td>
        </tr>
        <tr>
          <td>status bus</td>
          <td>Requests the core bus protocol version from the node device</td>
        </tr>
        <tr>
          <td>status version</td>
          <td>Requests the device-specific version number from the device</td>
        </tr>
        <tr>
          <td>address &lt;newaddress&gt;</td>
          <td>Change device address to &lt;newaddress&gt;</td>
        </tr>
      </tbody>
    </table>
    <h3><a name="bcast">Broadcast Commands</a></h3>
    <p>In addition to commands directed to a specific device, the MoCoBus
      protocol allows for broadcast commands to be sent to all devices on a bus.
      When using a broadcast command, it will be sent to all devices on the
      network, on every bus. A broadcast command is identified by being directed
      to a device named 'broadcast', for example:</p>
    <blockquote>
      <pre>broadcast start<br /></pre>
    </blockquote>
    <p>All broadcast commands are built-in, and only devices which support them
      will react to them. No devices will respond to a broadcast command, and
      therefor the result of a broadcast command will be success.</p>
    <p>The following broadcast commands are supported:</p>
    <p></p>
    <table width="100%" border="1">
      <tbody>
        <tr>
          <td><b>Command</b><br />
          </td>
          <td><b>Description</b><br />
          </td>
        </tr>
        <tr>
          <td>start<br />
          </td>
          <td>For devices that support automatic operation, start operating
            automatically<br />
          </td>
        </tr>
        <tr>
          <td>stop<br />
          </td>
          <td>For devices that support automatic operation, stop operating
            automatically<br />
          </td>
        </tr>
        <tr>
          <td>pause<br />
          </td>
          <td>For devices that support automatic operation, pause operating
            automatically<br />
          </td>
        </tr>
      </tbody>
    </table>
    <pre></pre>
    <p><br />
    </p>
    <h1 id="Supported"><a name="supdev">Supported Node Device Documentation</a></h1>
    <h2 id="nanoMoCo"><a name="nanomoco">nanoMoCo</a></h2>
    <p>The nanoMoCo node device type provides advanced control over a single
      stepper motor and a single camera. Multiple nanoMoCo devices can be used
      to synchronize movement between multiple stepper-driven axes. nanoMoCo
      devices provide the ability to either interactively control each axis as
      needed, or to run autonomously after configuration throughout the duration
      of a shot.</p>
    <p>While the nanoMoCo controllers are designed for photographic and video
      use, they can also be used for many other purposes involving stepper motor
      automation.</p>
    <h3 id="Basic"><a name="nmbasic">Basic Workflow</a></h3>
    <p>Whether using a nanoMoCo device in interactive, or automatic operation,
      the first step in working with the nanoMoCo device is to set the basic
      parameters for operation. You will want to determine if the motor and
      camera should be enabled, whether the driver should be disabled between
      moves, and the parameters for how the motor and camera will operate. While
      the complete scripting language is documented below, the following is a
      brief example of a script for an axis named 'pan', performing the setup
      operations:</p>
    <code></code>
    <blockquote>
      <pre> # enable the motor
pan motor enable
 # set the maximum speed in steps/second
pan max speed 1000
 # enable the camera
pan camera enable
 # link focus with shutter control
pan tie on
 # set microsteps setting for motor driver
pan ms 8<br /></pre>
    </blockquote>
    <p></p>
    <h3><a id="Support" name="nmsup">All Supported Commands</a></h3>
    <p>The following is a complete list of supported Slim script commands for
      this device type, with detailed documentation below the table:</p>
    <table border="1" style="width: 100%">
      <caption><br />
      </caption> <colgroup><col /> <col /> </colgroup>
      <tbody>
        <tr>
          <td><strong>Command</strong></td>
          <td><strong>Description</strong></td>
        </tr>
        <tr>
          <td><strong>General Commands</strong></td>
          <td><br />
          </td>
        </tr>
        <tr>
          <td>start</td>
          <td>Start automatic operation</td>
        </tr>
        <tr>
          <td>stop</td>
          <td>Stop automatic operation, clear out all runtime parameters</td>
        </tr>
        <tr>
          <td>pause</td>
          <td>Pause automatic operation, leaving runtime parameters in-place</td>
        </tr>
        <tr>
          <td>debug</td>
          <td>Enable or Disable debug output pin</td>
        </tr>
        <tr>
          <td>status</td>
          <td>Request current information</td>
        </tr>
        <tr>
          <td>master</td>
          <td>Set as timing master or timing slave</td>
        </tr>
        <tr>
          <td>max</td>
          <td>Control maximum operating parameters</td>
        </tr>
        <tr>
          <td><strong>Motor Commands</strong></td>
          <td><br />
          </td>
        </tr>
        <tr>
          <td>motor</td>
          <td>Enable or Disable motor</td>
        </tr>
        <tr>
          <td>ms</td>
          <td>Set motor microstep value</td>
        </tr>
        <tr>
          <td>sleep</td>
          <td>Enable or Disable sleeping the stepper driver between movements</td>
        </tr>
        <tr>
          <td>continuous</td>
          <td>Enable or Disable continuous movement</td>
        </tr>
        <tr>
          <td>speed</td>
          <td>Set current continuous movement speed</td>
        </tr>
        <tr>
          <td>stopmotor</td>
          <td>Stop continuous motion currently running</td>
        </tr>
        <tr>
          <td>move</td>
          <td>Make a movement immediately</td>
        </tr>
        <tr>
          <td>easing</td>
          <td>Set movement easing algorithm</td>
        </tr>
        <tr>
          <td>sethome</td>
          <td>Set current position as home</td>
        </tr>
        <tr>
          <td>home</td>
          <td>Return immediately to home</td>
        </tr>
        <tr>
          <td>steps</td>
          <td>Set # of steps between shots for automatic operation</td>
        </tr>
        <tr>
          <td>plan</td>
          <td>Plan an interleaved motion path for automatic operation</td>
        </tr>
        <tr>
          <td><strong>Camera Commands</strong></td>
          <td><br />
          </td>
        </tr>
        <tr>
          <td>camera</td>
          <td>Enable or Disable the camera control</td>
        </tr>
        <tr>
          <td>expose</td>
          <td>Expose the camera now</td>
        </tr>
        <tr>
          <td>tie</td>
          <td>Tie focus line to shutter line Enable or Disable</td>
        </tr>
        <tr>
          <td>interval</td>
          <td>Set the interval time for automatic operation</td>
        </tr>
        <tr>
          <td>exposure</td>
          <td>Set the exposure time for automatic operation</td>
        </tr>
        <tr>
          <td>focus</td>
          <td>Set the focus time for automatic operation</td>
        </tr>
        <tr>
          <td>delay</td>
          <td>Set the post-exposure delay time for automatic operation</td>
        </tr>
        <tr>
          <td>repeat</td>
          <td>Set the repeat count for each exposure in automatic operation</td>
        </tr>
      </tbody>
    </table>
    <p></p>
    <h4>General Commands</h4>
    <p>start</p>
    <p style="margin-left:2em;">Starts automatic operation immediately</p>
    <p></p>
    <p>stop</p>
    <p style="margin-left:2em;">Stops automatic operation immediately, clears
      out all runtime parameters. Can also be used to clear out step limit, shot
      count, and steps moved in interactive control.</p>
    <p></p>
    <p>pause</p>
    <p style="margin-left:2em;">Pauses automatic operation, without clearing any
      runtime parameters. Use start to re-start operation where it left off</p>
    <p></p>
    <p>debug [on|off]</p>
    <p style="margin-left:2em;">Turns on or off the debug output. This output
      may typically be used to run an LED or perform some other action.</p>
    <p></p>
    <p>status &lt;parameter&gt;</p>
    <p style="margin-left:2em;">Requests current status from the node, can ask
      for one of the following parameters:</p>
    <table border="1" style="width: 100%">
      <caption><br />
      </caption> <colgroup><col /> <col /> </colgroup>
      <tbody>
        <tr>
          <td><strong>Parameter</strong></td>
          <td><strong>Description</strong></td>
        </tr>
        <tr>
          <td>time</td>
          <td>Get current runtime (in mS)</td>
        </tr>
        <tr>
          <td>interval</td>
          <td>Get current interval value</td>
        </tr>
        <tr>
          <td>exposure</td>
          <td>Get current exposure value</td>
        </tr>
        <tr>
          <td>delay</td>
          <td>Get current delay value</td>
        </tr>
        <tr>
          <td>shots</td>
          <td>Get current shot count</td>
        </tr>
        <tr>
          <td>camera</td>
          <td>Get current camera enable value</td>
        </tr>
        <tr>
          <td>exposing</td>
          <td>Whether camera is currently exposing</td>
        </tr>
        <tr>
          <td>motor</td>
          <td>Get current motor enable value</td>
        </tr>
        <tr>
          <td>moved</td>
          <td>Get current steps moved value</td>
        </tr>
        <tr>
          <td>home</td>
          <td>Get distance from home</td>
        </tr>
      </tbody>
    </table>
    <p></p>
    <p>master [true|false]</p>
    <p style="margin-left:2em;">Enable or disable timing master for this node.
      See "Multi-Node Operation" below.</p>
    <p></p>
    <p>max &lt;parameter&gt; &lt;value&gt;</p>
    <p style="margin-left:2em;">Sets a limit parameter maximum value. The
      following parameters are supported:</p>
    <table border="1" style="width: 100%">
      <caption><br />
      </caption> <colgroup><col /> <col /> </colgroup>
      <tbody>
        <tr>
          <td><strong>Parameter</strong></td>
          <td><strong>Description</strong></td>
        </tr>
        <tr>
          <td>shots</td>
          <td>Maximum number of shots before automatic program stops executing</td>
        </tr>
        <tr>
          <td>steps</td>
          <td>Maximum number of steps before motor movement will be prevented</td>
        </tr>
        <tr>
          <td>speed</td>
          <td>Maximum speed (in steps/sec) of any continuous movement</td>
        </tr>
        <tr>
          <td>rate</td>
          <td>Maximum stepping rate of the internal stepper control</td>
        </tr>
      </tbody>
    </table>
    <p></p>
    <p></p>
    <h4>Motor Commands</h4>
    <p>motor [enable|disable]</p>
    <p style="margin-left:2em;">Enables or disabled motor control. If disabled,
      you will not be able to make the motor move at all.</p>
    <p></p>
    <p>ms [1|2|4|8|16]</p>
    <p style="margin-left:2em;">Sets the microstep amount to one of five legal
      values. A value of 1 indicates no microstepping. Takes immediate effect.</p>
    <p></p>
    <p>sleep [enable|disable]</p>
    <p style="margin-left:2em;">Enable or disable sleeping of the motor driver
      between moves. This saves power by not using motor current between moves,
      but will require external braking of some sort for many types of axes.
      This is enabled by default.</p>
    <p></p>
    <p>continuous [enable|disable]</p>
    <p style="margin-left:2em;">Enable or Disable continuous (always running)
      motion. See "Motion Control" below.</p>
    <p></p>
    <p>speed &lt;value&gt;</p>
    <blockquote>Sets current continuous motion speed, in steps/second. See
      "Motion Control" below.<br />
    </blockquote>
    stopmotor<br />
    <blockquote>Stops the motor from continuous or other motion immediately,
      without also stopping the execution of automatic operation if currently
      playing.<br />
    </blockquote>
    move ...<br />
    <blockquote>Execute a move immediately. See "Motion Control" below for more
      information.<br />
    </blockquote>
    easing [linear|quad|invquad]<br />
    <blockquote>Set the easing type for moves with easing. Can specify linear,
      quadratic, or inverse quadratic. See "Easing Algorithms" below.<br />
    </blockquote>
    sethome<br />
    <blockquote>Sets the current position of the motor as "home"<br />
    </blockquote>
    home<br />
    <blockquote>Sends motor to the "home" position immediately<br />
    </blockquote>
    steps &lt;steps&gt;<br />
    <blockquote>Sets the number of steps to move at each interval in automatic
      operation, for simplistic motion profiles. See "Motion Control" below.<br />
    </blockquote>
    plan ...<br />
    <blockquote>Plans a complex movement in interleaved (shoot-move-shoot)
      motion. See "Motion Control" below.<br />
      <br />
    </blockquote>
    <h4>Camera Commands</h4>
    <p>camera [enable|disable]</p>
    <blockquote>
      <p>Enables or disables the camera exposure output</p>
    </blockquote>
    <p>expose &lt;ms&gt;</p>
    <blockquote>
      <p>Immediately expose the camera for &lt;ms&gt; milliseconds</p>
    </blockquote>
    <p>tie [enable|disable]</p>
    <blockquote>
      <p>Tie the focus line to the shutter line such that the focus line is
        always activated when the shutter line is activated. This resolves many
        shutter control issues for many cameras.</p>
    </blockquote>
    <p>interval &lt;ms&gt;</p>
    <blockquote>
      <p>Set the intervalometer time in milliseconds. See "Motion Control" below.</p>
    </blockquote>
    <p>exposure &lt;ms&gt;</p>
    <blockquote>
      <p>Set the exposure time for the camera control in automatic operation.
        Set to 0, or disable the camera to prevent exposure during automatic
        operation.<br />
      </p>
    </blockquote>
    <p>focus &lt;ms&gt;</p>
    <blockquote>
      <p>Set the focus time for the camera control in automatic operation. Set
        to 0 to prevent focusing during automatic operation.</p>
    </blockquote>
    <p>delay &lt;ms&gt;</p>
    <blockquote>
      <p>Set the post-exposure delay for the camera control in automatic
        operation. Set to 0 to prevent delaying after exposure during automatic
        operation.</p>
    </blockquote>
    <p>repeat &lt;count&gt;</p>
    <blockquote>
      <p>Set the exposure repeat count for automatic operation. Exposure cycle
        will repeat this many times. See "Automatic Operation Workflow" below.</p>
    </blockquote>
    <p><br />
    </p>
    <h3><a name="nmmoco">Motion Control</a></h3>
    <p>Motion control with the nanoMoCo controllers is achieved in one of two
      ways, either interactively by issuing commands as-needed, or automatically
      by specifying the parameters of the shot and letting the nanoMoCo perform
      the required activities as needed.</p>
    <p>For most video-based works, motion will happen continuously. That is,
      whether shooting time-lapse or real-time video, the motors will continue
      to move until they reach their desired destination as the camera records.
      For certain types of timelapse and stop-motion shooting, it is
      advantageous to only move the motors when the camera is not recording -
      this type of movement is referred to as "interleaved," or
      "shoot-move-shoot." The nanoMoCo controllers have the ability to perform
      either type of motion, with different options appropriate to your specific
      workflow.</p>
    <h4>Making Moves</h4>
    <p>The nanoMoCo is capable of automatically making simple and complex moves
      - both in real-time and in interleaved motion. For real-time moves, rapid
      positioning, and continuous motion, the move command is used. There are
      two forms of this command:</p>
    <blockquote>
      <pre>move &lt;direction&gt; &lt;steps&gt;<br />move &lt;direction&gt; &lt;steps&gt; &lt;time to arrive&gt; &lt;time to accel&gt; &lt;time to decel&gt;<br /></pre>
    </blockquote>
    In the first form, this is considered a "simple move". The axis moves at the
    currently configured <em>max speed</em> until it reaches the destination
    (specified in steps), with a short and fixed acceleration and deceleration
    period. This is typically used as a positioning activity, and would rarely
    be used to create the video motion, as it offers little control. The second
    form of this command defines a complex move where a destination is
    specified, an arrival time, an amount of time to accelerate, and an amount
    of time to decelerate. All times are expressed in milliseconds. When using
    the complex move form, the accel/decel profile is specified with the <em>easing</em>
    command. The following is an example of making a complex move in a
    continuous fashion, with quadratic easing:<br />
    <br />
    <blockquote>
      <pre>slider easing quad<br />slider move true 10000 60000 15000 5000<br /></pre>
    </blockquote>
    In the above example, an axis named 'slider' is moved in the true direction
    for 10,000 steps. The axis will arrive at the destination in one minute
    (60,000 mS), accelerate to full speed over 15 seconds, and decelerate over 5
    seconds. The motor will automatically stop upon reaching the destination.<br />
    <br />
    Directions are specified as true, false, 1, or 0. The nanoMoCo controller
    does not know what up, down, left, or right means - it knows a motor can
    move in one of two directions. "true" is a synonym for 1, and "false" for 0.<br />
    <br />
    <strong>A note of warning</strong>: it is possible to specify a move that
    requires your motor to move faster than it actually can. Complex moves do
    NOT use the <em>max speed</em> parameter, they always attempt to achieve
    your requested move - whether or not the motor actually can. Simple moves
    always move at your specified <em>max speed</em>.<br />
    <br />
    Of course, when doing a continuous move, you may not know the destination,
    or you may just want to move for a very long time at a fixed speed - and
    stop the motor manually. This is a simple, continuous move. To perform moves
    like this, you would instruct the nanoMoCo axis to go into continuous mode,
    and manually control the speed:<br />
    <blockquote>
      <pre>slider continuous enable<br />slider speed 500<br />slider move true 0<br /></pre>
    </blockquote>
    Note the structure of the simple move command: it is told to move zero
    steps. When in continuous mode, this allows you to still do basic
    positioning with a standard simple move command while being able to move
    continuously when needed. You can change the speed anytime during the
    movement using the <em>speed</em> command, and the effects will be
    immediate. To stop the motion, use the stopmotor command:<br />
    <blockquote>
      <pre>slider stopmotor<br /></pre>
    </blockquote>
    Interleaved motion requires automatic operation, and is covered in the next
    sub-section.<br />
    <pre><br /></pre>
    <h4>Automatic Operation</h4>
    <p>In automatic operation, the nanoMoCo controller performs all actions at
      the right time on your behalf, after having been configured. Timing of
      events is controlled by the internal intervalometer, even if the camera is
      not being controlled. </p>
    <p>In automatic operation, the intervalometer fires at the requested
      interval, and triggers an exposure cycle if the camera is enabled. If the
      motor is also enabled, it is controlled as needed. All parameters for
      operation are set, and then a <em>start</em> command is issued to begin
      operations.<br />
    </p>
    <p>For continuous movement in automatic operation, the easiest form is to
      use the single-speed continuous motion, e.g. by enabling continuous
      motion, the motor, and specifying the speed. The following script example
      would fire the camera every 5 seconds, while moving continuously at 50
      steps/second:</p>
    <blockquote>
      <pre>slider motor enable<br />slider continuous enable<br />slider speed 50<br />slider camera enable<br />slider exposure 100<br />slider interval 5000<br />slider start<br /></pre>
    </blockquote>
    Of course, this results in fairly boring movement. We can use a complex form
    of a continuous move as well, after starting automatic operation:<br />
    <blockquote>
      <pre>slider motor enable<br />slider continuous disable<br />slider camera enable<br />slider exposure 100<br />slider interval 5000<br />slider start<br />slider move true 10000 3600000 900000 30000<br /></pre>
    </blockquote>
    In this case, we move 10,000 steps over an hour, with 15 minutes up ramp-up
    time and 30 seconds of ramp-down time. Note that we disabled continuous
    motion, as we're using an advanced move to control the motion.<br />
    <br />
    When we want to interleave motion between exposures, we have two options:
    either make a fixed distance move between each shot, or plan a complex
    interleaved cycle with acceleration and deceleration. The first form would
    most likely be used for stop-motion style animation, whereas the latter
    would be used in normal timelapse work where gentle acceleration is desired.
    To perform fixed moves between shots, we need only to specify how far to
    move with the <em>steps</em> command, and we use the <em>max speed</em>
    setting to limit how fast those steps are taken in a move:<br />
    <blockquote>
      <pre>slider motor enable<br />slider continuous disable<br />slider steps 100<br />slider max speed 500<br />slider camera enable<br />slider exposure 100<br />slider interval 5000<br />slider start<br /></pre>
    </blockquote>
    Now, to make a complex move with acceleration and deceleration, we can use
    the <em>plan</em> command which will plan out a sequence of interleaved
    moves for us to achieve our goals. The <em>plan</em> command has the same
    argument structure as a complex move, but instead of time in milliseconds,
    it uses intervals (or shots, as it were):<br />
    <blockquote>
      <pre>slider motor enable<br />slider continuous disable<br />slider max speed 500<br />slider plan true 10000 720 20 20<br />...<br />slider start<br /></pre>
    </blockquote>
    In this case, we're moving 10,000 steps over 720 shots (1 hour at 5 second
    intervals), with 20 shots to accelerate to full speed, and 20 shots to
    decelerate to a stop. Automatic operation will automatically stop when the
    planned move is complete.<br />
    <br />
    <h4>Stopping Automatic Operation</h4>
    <p>We can stop automatic operation directly by using the <em>stop</em>
      command. However, we can also have automatic operation stop automatically
      one of two ways:</p>
    <ol>
      <li>Specifying a maximum shot count</li>
      <li>Planning an interleaved sequence</li>
    </ol>
    <p>If you specify a maximum shot count, automatic operation will stop
      immediately after that number of shots have been taken. When a planned
      interleaved movement is completed, movement will automatically be stopped
      as well. If both a maximum shot count AND a planned interleaved sequence
      is used the first one to reach its end will cause the problem to stop.</p>
    <p>If you specify a max steps parameter, it will stop the motor from moving
      (whether continuous or interleaved) when the max steps is complete, but
      will not otherwise stop automatic operation.</p>
    <p>You can pause automatic operation at any time using the <em>pause</em>
      command, and start where you left off again using the <em>start</em>
      command.<br />
    </p>
    <h4>Automatic Operation Workflow<br />
    </h4>
    <blockquote>
      <pre></pre>
    </blockquote>
    <p> 1: Interval timer triggers or slave clear signal received</p>
    <p> 2: Determine if the camera should be fired<br />
      2.a: camera is enabled<br />
      2.a.1: trigger focus<br />
      2.a.2: on focus complete, trigger shutter<br />
      2.a.3: on shutter complete, trigger post-exposure delay<br />
      2.a.4: on post-exposure delay complete, go to 2.b<br />
      2.b: Check camera repeat cycle<br />
      2.b.1: camera exposure is to be repeated<br />
      2.b.1.a: repeat count not yet achieved<br />
      2.b.1.a.1: go to 2.a.1, increment repeat counter<br />
      2.b.1.b: repeat count achieved<br />
      2.b.1.b.1: clear repeat counter<br />
      2.b.1.b.2: go to 3<br />
      <br />
      3: Determine if motor should be moved<br />
      3.a: motor should be moved, continuous motion<br />
      3.a.1: Motor not running, not yet at final position<br />
      3.a.1.a: start motor moving<br />
      3.a.1.b: go to 1<br />
      3.a.2: Motor running, not yet at final position OR motor not running, at
      final position<br />
      3.a.2.a: go to 1<br />
      3.b: motor should be moved, interleaved motion<br />
      3.b.1: Not yet at final position<br />
      3.b.1.a: move motor specified amount<br />
      3.b.1.b: block state engine until move complete<br />
      3.b.1.c: go to 1<br />
      3.b.2: Motor at final position<br />
      3.b.2.a: go to 1<br />
      3.c.: motor should not be moved (not enabled)<br />
      3.c.1: go to 1<br />
    </p>
    <br />
    Note that in continuous motion the motor will move while the camera is
    exposing, but in interleaved motion the camera can not fire during a
    movement (3.b.1.b). <br />
    <br />
    <h3><a name="nmmulti">Multi-Node Operation</a></h3>
    <p>Using multiple nanoMoCo nodes together, you can create highly complex
      sequences of movement. To keep nodes synchronized, you must connect the
      Common lines of all nodes together, and then elect a single timing master
      among them. The timing master will be node that controls the primary
      camera (if camera control is desired), and will be the only node with an
      intervalometer running. The remaining nodes will execute their workflow
      steps when a slave clear signal is sent by the master down the common
      lines. The following script demonstrates three nodes, slider, pan, and
      tilt, operating together with the tilt being the node controlling the
      camera:</p>
    <blockquote>
      <pre>tilt master enable<br />tilt motor enable<br />tilt continuous disable<br />tilt plan true 10000 720 20 20
tilt camera enable<br />tilt exposure 100<br />tilt interval 5000<br /><br />pan master disable<br />pan motor enable<br />pan continuous disable<br />pan plan true 10000 720 20 20
pan camera disable<br /><br />slider master disable<br />slider motor enable<br />slider continuous disable<br />slider plan true 10000 720 20 20<br />slider camera disable<br /><br />broadcast start<br /></pre>
    </blockquote>
    <p>Note that we used the broadcast start command here. This starts all nodes
      together, in sequence and at the same time. nanoMoCo respond to all of the
      following broadcast commands: start, stop, pause.<br />
    </p>
    <h3><a name="nmease">Easing Algorithms</a></h3>
    <p>There are two primary algorithms supported for easing: linear and
      quadratic. All easing methods can be applied at the maximum step rate of
      5,000 steps/second.</p>
    <p>Linear easing allows for quick and highly accurate move calculations. The
      position of the motor in space follows a smooth, natural curve - however
      the acceleration profile is entirely linear. This can result in some
      moves, especially real-time video moves appearing "robotic" or
      "mechanical" in the output video. However, some moves will benefit from
      this method, especially very precise moves as linear easing has no error
      during a real-time move, whereas quadratic easing has a very small error
      rate which becomes more apparent in shorter moves. (This error rate is
      usually less than 0.05 steps past the expected position, meaning it has
      little impact on most moves.)</p>
    <p>Quadratic easing provides an acceleration curve which is non-linear, and
      can provide smooth transitions in speed - with a fluid curve that appears
      more like that which a human can produce rather than the linear change in
      speed produced by a computer.</p>
    <p>The following diagrams show the difference between linear and quadratic
      easing applied to the same move of 2,000 steps over 500 seconds, with 100
      seconds in acceleration and 200 in deceleration:</p>
    <div class="image"> <img alt="chart_mposprofile.png" src="chart_mposprofile.png" />
    </div>
    <div class="image"> <img alt="chart_mspeedprofile.png" src="chart_mspeedprofile.png" />
    </div>
    <p>As we can see from the above graphs, both moves arrive at the same point
      and at the same time and reach their top speeds at the same time, but the
      quadratic acceleration profile results in a higher top speed where the
      acceleration begins slowly and then increases as it nears the crusing
      speed. Quadratic deceleration, likewise, starts decelerating slowly and
      increases as the move reaches a stop.</p>
    <p>While normal quadratic easing provides us a period where acceleration
      increases as we reach the top speed, there are cases where it would be
      advantageous to do the inverse - that is, invert the acceleration curve so
      that it starts at the maximum acceleration rate and the rate of
      acceleration decreases as the move nears its cruising speed. This easing
      mode is provided as the inverse quadratic easing mode.</p>
    <p>The following diagrams illustrate the difference between the two forms of
      easing and their effects on the placement and speed of the motor over
      time:</p>
    <div class="image"> <img alt="chart_miqpos.png" src="chart_miqpos.png" /> </div>
    <div class="image"> <img alt="chart_miqspeed.png" src="chart_miqspeed.png" />
    </div>
    <p>Here we find that the acceleration begins so sharply that the maximum
      speed is reduced.</p>
    <p>Using an inverse quadratic easing algorithm with acceleration and
      deceleration periods nearest to dead-center in time will result in an
      approximation of the smoothstep algorithm. E.g.: specifying a move of 2000
      steps, over 500 seconds with 249 seconds spent accelerating and 249
      seconds spent decelerating, results in the following speed profile:</p>
    <div class="image"> <img alt="chart_mqs.png" src="chart_mqs.png" /> </div>
    <p></p>
    <pre> <br /></pre>
    <blockquote>
      <pre><br /><br /><br /></pre>
    </blockquote>
    <br />
    <br />
  </body>
</html>
